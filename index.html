<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgroMart — Marketplace Pupuk & Bibit</title>
  <meta name="description" content="AgroMart - Marketplace pupuk, bibit, dan perlengkapan pertanian. Tema hijau elegan." />

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark topbar sticky-top">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center gap-2" href="#">
      <img src="img/Logo.png" alt="AgroMart Logo" class="rounded shadow-sm" style="height:40px; width:auto;">
      <div class="ms-1 lh-sm">
        <strong>AgroMart</strong><br>
        <small class="text-muted">Pupuk • Bibit • Perkakas</small>
      </div>
    </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMenu">
        <form class="d-flex ms-auto me-3" onsubmit="event.preventDefault(); doSearch();">
          <input id="searchBox" class="form-control form-control-sm me-2" type="search" placeholder="Cari produk (contoh: bibit cabai)" />
          <button class="btn btn-outline-light btn-sm" onclick="doSearch()" type="button"><i class="bi bi-search"></i></button>
        </form>

        <ul class="navbar-nav align-items-center">
          <li class="nav-item me-2"><a class="nav-link" href="#produk">Produk</a></li>
          <li class="nav-item me-2"><a class="nav-link" href="#orders">Pesanan</a></li>
          <li class="nav-item me-2"><a class="nav-link" href="#tentang">Tentang</a></li>
          <li class="nav-item me-2">
            <button class="btn btn-warning btn-sm" onclick="toggleCart()">
              <i class="bi bi-cart4"></i> <span id="cart-count">0</span>
            </button>
          </li>
          <li class="nav-item" id="user-area"></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero d-flex align-items-center">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-7 text-white">
          <h1 class="display-5 fw-bold">AgroMart — Solusi Pertanian Modern</h1>
          <p class="lead">Pupuk organik, bibit unggul, alat pertanian — pembayaran fleksibel & pelacakan pesanan.</p>
          <div class="mt-3">
            <a href="#produk" class="btn btn-light btn-lg me-2">Belanja Sekarang</a>
            <button class="btn btn-outline-light btn-lg" onclick="showLoginModal()">Masuk / Daftar</button>
          </div>
        </div>
        <div class="col-md-5 text-end d-none d-md-block">
          <img src="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=500&q=60"
               alt="hero" class="rounded hero-img shadow-lg">
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container my-5">
    <div class="row">
      <!-- SIDEBAR -->
      <aside class="col-lg-3 mb-4">
        <div class="card shadow-sm p-3 mb-3">
          <h6 class="mb-2">Kategori</h6>
          <div id="categories" class="d-flex flex-column gap-2"></div>
        </div>

        <div class="card shadow-sm p-3 mb-3">
          <h6 class="mb-2">Filter & Sort</h6>
          <div class="mb-2">
            <label class="form-label small">Harga (Rp)</label>
            <div class="d-flex gap-2">
              <input id="minPrice" type="number" class="form-control form-control-sm" placeholder="Min">
              <input id="maxPrice" type="number" class="form-control form-control-sm" placeholder="Max">
            </div>
          </div>
          <div>
            <label class="form-label small">Urutkan</label>
            <select id="sortBy" class="form-select form-select-sm" onchange="renderProducts()">
              <option value="popular">Populer</option>
              <option value="low">Harga: Terendah</option>
              <option value="high">Harga: Tertinggi</option>
              <option value="new">Terbaru</option>
            </select>
          </div>
          <div class="mt-2 d-flex gap-2">
            <button class="btn btn-success btn-sm" onclick="applyFilters()">Terapkan</button>
            <button class="btn btn-outline-secondary btn-sm" onclick="resetFilters()">Reset</button>
          </div>
        </div>

        <div class="card shadow-sm p-3">
          <h6 class="mb-2">Tentang AgroMart</h6>
          <p class="small text-muted">Marketplace pertanian untuk pupuk, bibit, dan peralatan berkualitas.</p>
        </div>
      </aside>

      <!-- PRODUCTS -->
      <section id="produk" class="col-lg-9">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Produk</h5>
          <div class="d-flex gap-2 align-items-center">
            <button class="btn btn-outline-secondary btn-sm" onclick="resetFilters()">Reset</button>
            <a href="#orders" class="btn btn-outline-dark btn-sm">Pesanan</a>
          </div>
        </div>

        <div id="productGrid" class="row g-4"></div>

        <nav class="mt-4">
          <ul id="pagination" class="pagination pagination-sm"></ul>
        </nav>
      </section>
    </div>

    <!-- ORDERS -->
    <section id="orders" class="mt-5">
      <h4>Riwayat Pesanan</h4>
      <div id="orders-list" class="mt-3"></div>
    </section>
  </main>

  <!-- CART DRAWER -->
  <div class="cart-panel" id="cart">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="mb-0">Keranjang</h5>
      <button class="btn btn-sm btn-outline-secondary" onclick="toggleCart()"><i class="bi bi-x"></i></button>
    </div>

    <ul id="cart-items" class="list-group mb-3"></ul>

    <div class="mb-3">
      <label class="form-label small">Metode Pembayaran</label>
      <select id="paymentMethod" class="form-select form-select-sm">
        <option value="transfer">Transfer Bank</option>
        <option value="ewallet">E-Wallet (Gopay/OVO/Dana)</option>
        <option value="cod">Bayar di Tempat (COD)</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label small">Alamat Pengiriman</label>
      <textarea id="shippingAddress" class="form-control form-control-sm" rows="2" placeholder="Nama jalan, kecamatan, kabupaten"></textarea>
    </div>

    <div class="d-grid gap-2 sticky-footer">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div class="small text-muted">Total</div>
        <strong>Rp <span id="cart-total">0</span></strong>
      </div>
      <button class="btn btn-success" onclick="checkout()">Checkout</button>
      <button class="btn btn-outline-secondary" onclick="clearCart()">Kosongkan</button>
      <button class="btn btn-link text-decoration-none" onclick="openWhatsAppCart()"><i class="bi bi-whatsapp"></i> Chat via WhatsApp</button>
    </div>
  </div>

  <!-- MODALS -->
  <!-- Product Modal -->
  <div class="modal fade" id="productModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body p-4">
          <div class="row">
            <div class="col-md-6">
              <img id="productModalImg" src="" class="img-fluid rounded mb-3" alt="">
            </div>
            <div class="col-md-6">
              <h5 id="productModalName"></h5>
              <div class="mb-2"><strong>Rp <span id="productModalPrice"></span></strong></div>
              <p id="productModalDesc" class="small text-muted"></p>

              <div class="mb-3">
                <label class="form-label small">Jumlah</label>
                <input id="productQty" type="number" value="1" min="1" class="form-control form-control-sm" style="width:110px">
              </div>

              <div class="d-flex gap-2 mb-3">
                <button class="btn btn-success" id="addToCartBtn">Tambah ke Keranjang</button>
                <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Tutup</button>
              </div>

              <hr>
              <h6>Ulasan</h6>
              <div id="reviewsList" class="mb-3"></div>

              <div>
                <input id="reviewName" class="form-control form-control-sm mb-2" placeholder="Nama" />
                <textarea id="reviewText" class="form-control form-control-sm mb-2" placeholder="Tulis ulasan..."></textarea>
                <button class="btn btn-outline-success btn-sm" onclick="addReview()">Kirim Ulasan</button>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="modal fade" id="authModal" tabindex="-1">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header"><h6 id="authTitle">Login</h6><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body p-3">
          <div id="loginForm">
            <input id="loginEmail" class="form-control form-control-sm mb-2" placeholder="Email" />
            <input id="loginPass" type="password" class="form-control form-control-sm mb-2" placeholder="Password" />
            <button class="btn btn-success w-100" onclick="login()">Login</button>
            <div class="mt-2 text-center small"><a href="#" onclick="showRegister();return false;">Belum punya akun? Daftar</a></div>
          </div>
          <div id="registerForm" style="display:none">
            <input id="regName" class="form-control form-control-sm mb-2" placeholder="Nama lengkap" />
            <input id="regEmail" class="form-control form-control-sm mb-2" placeholder="Email" />
            <input id="regPass" type="password" class="form-control form-control-sm mb-2" placeholder="Password" />
            <button class="btn btn-success w-100" onclick="register()">Daftar</button>
            <div class="mt-2 text-center small"><a href="#" onclick="showLogin();return false;">Sudah punya akun? Login</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tracking Modal (progress bar) -->
  <div class="modal fade" id="trackingModal" tabindex="-1">
    <div class="modal-dialog modal-md modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h6>Pelacakan Pesanan <span id="trackingOrderId"></span></h6>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-3">
          <div class="mb-3">
            <div class="small text-muted">Status:</div>
            <div class="progress" style="height:18px">
              <div id="trackingProgress" class="progress-bar" role="progressbar" style="width:0%">0%</div>
            </div>
          </div>
          <div id="trackingText" class="small"></div>
          <div class="mt-3 d-flex gap-2">
            <button class="btn btn-outline-secondary btn-sm" onclick="simulateProgress()">Simulasi Update</button>
            <button class="btn btn-success btn-sm" onclick="closeTracking()">Tutup</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="py-4 text-center small text-muted">
    &copy; 2025 AgroMart • Fajar Nurulloh & Muhammad Lutfi Alfin
  </footer>

 <!-- Floating WhatsApp -->
  <a href="https://wa.me/628816569904?text=Halo%20AgroMart%2C%20saya%20ingin%20bertanya%20tentang%20produk."
     target="_blank" class="whatsapp-float">
    <i class="bi bi-whatsapp"></i>
  </a>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>

</body>
</html>
